//@charset "utf-8";
function drawFs(e,t){var i;fenshiPainter||(i=new FenshiChart(t)),i.paint(e)}function FenshiData(e,t){this.options=e,this.fsOptions=t,this.chart=null,this.url="http://qd.10jqka.com.cn/api.php?info="+this.options.info+"&fq="+this.options.fq+"&start="+this.options.starttime,this.refresh(this.url)}function drawKL(e,t,i){if(!painter){var a=new kLine(i);painter=new Painter(i.canvas.id,a,t)}painter.dataRanges=e,painter.paint()}function klData(e,t){this.options=e,this.kChartOptions=t}function klData(e,t){this.options=e,this.kChartOptions=t}var fenshiPainter;FenshiData.prototype={getToday:function(){var e=new Date;return e.getDay()},init:function(){var e=this;null==e.chart||"undefined"==typeof e.chart,e.refresh(e.url)},stopRefresh:function(e){clearTimeout(e)},refresh:function(e){var t,i=this,a=i.getToday();(6==a||1==a)&&i.stopRefresh(i.t),i.t=setTimeout(function(){i.refresh(i.url)},i.options.duration),t&&document.body.removeChild(t),t=document.createElement("script"),t.src=e,t.onload=function(){var e,t=i.options.info,a=i.parseData(window[t]),o=a.mins,n=i.getAxisMaxAndMin(o);o.length>0&&(e={quote:{date:a.day,preClose:a.preClose,minute:o[o.length-1].minute,price:o[o.length-1].price,volume:o[o.length-1].volume,average:o[o.length-1].average,minPrice:n.yMin,maxPrice:n.yMax},mins:o}),i.options.updateTip&&(i.fsOptions.updateTip=i.options.updateTip),drawFs(e,i.fsOptions)},document.body.appendChild(t)},formatTime:function(e){if("string"==typeof e&&null!=e){var t=e.substr(e.length-2,2),i=e.substr(0,2);return i+":"+t}},parseData:function(e){for(var t=e.split("|")[1],i=t.split("~"),a=(i[0],parseFloat(i[1])),o=i[2].split(";"),n=[],r=0;r<o.length;r++){var l=o[r].split(","),s={minute:this.formatTime(l[0]),price:parseFloat(isNaN(parseFloat(l[1]))?l[2]:l[1]),average:parseFloat(isNaN(parseFloat(l[2]))?l[1]:l[2]),volume:parseFloat(l[3]),preClose:a};n.push(s)}for(var h=[],g=1,p=n.length;p>g;g++){var c,d=this.calcTimeDelta(n[g-1].minute,n[g].minute);if(1!=d||90!=d){var u=n[g-1];c={minute:this.formatTime(u.minute),price:u.price,average:u.average,volume:u.volume,preClose:u.preClose}}else c=n[g];h.push(c)}return{day:e.split("|")[0],preClose:a,mins:h}},getAxisMaxAndMin:function(e){for(var t=[],i=[],a=[],o=0;o<e.length;++o)t.push(e[o].minute),i.push(e[o].price),a.push(e[o].average);var n=Math.min.apply(null,i),r=Math.min.apply(null,a),l=Math.max.apply(null,i),s=Math.max.apply(null,a);return{xMin:t[0],xMax:t[t.length-1],yMin:Math.min(n,r),yMax:Math.max(l,s)}},calcTimeDelta:function(e,t){if(e&&t){var i=e.substr(e.length-2,2),a=e.substr(0,2),o=60*parseInt(a)+parseInt(i),n=t.substr(t.length-2,2),r=t.substr(0,2),l=60*parseInt(r)+parseInt(n);return Math.abs(l-o)}},calcLastTime:function(e){if(e){var t=parseInt(e.substr(e.length-2,2)),i=parseInt(e.substr(0,2)),a=t+1;a>=60&&(a-=60,i+=1),i=10>i?"0"+i:i;var o=i.toString()+t.toString();return o}}};var painter;klData.prototype={init:function(){var e,t=this,i="fq="+t.options.fq,a="p="+t.options.type,o="year="+t.options.time,n="info=k_sz_"+t.options.code+"&aid=1",r="http://qd.10jqka.com.cn/api.php",l=r+"?"+a+"&"+i+"&"+o+"&"+n;e&&document.removeChild(e),e=document.createElement("script"),e.src=l,e.onload=function(){var e=t.options.time,i=e.split(","),a=t.options.type,o="k";switch(a){case"stock_day":o+="_daily_";break;case"stock_week":o+="_week_";break;case"stock_month":o+="_month_";break;case"stock_min5":o+="_5_";break;case"stock_min15":o+="_15_";break;case"stock_min30":o+="_30_";break;case"stock_min60":o+="_60_"}if(o+=t.options.code,"stock_min5"==a||"stock_min15"==a||"stock_min30"==a||"stock_min60"==a){var n=t.parseData(window[o]);return void drawKL(null,n,t.kChartOptions)}result="";var n;if(1==i.length){result=result+o+"_"+e.substr(2,2);var n=t.parseData(window[result]);return void drawKL(null,n,t.kChartOptions)}for(var r=0;r<i.length;++r)result=1==i.length?result+o+"_"+i[r].substr(2,2):result+o+"_"+i[r].substr(2,2)+"+";result=result.substr(0,result.length-1);var l=result.split("+"),s="";for(r=0;r<l.length;++r)s+=window[l[r]];var n=t.parseData(s);drawKL(null,n,t.kChartOptions)},document.body.appendChild(e)},parseData:function(e){var t=this,i=e.split("|");i.pop();var a={},o=[];this.setDataLength(i.length);for(var n=0;n<i.length;n++){var r,l=i[n].split(",");if(0==l.length)break;var s;0==n?r={quoteTime:parseInt(l[0]),preClose:parseInt(0),open:parseFloat(l[1]),high:parseFloat(l[2]),low:parseFloat(l[3]),close:parseFloat(l[4]),volume:parseInt(l[5]),amount:parseInt(l[6])}:(s=i[n-1].split(","),r={quoteTime:parseInt(l[0]),preClose:parseFloat(s[4]),open:parseFloat(l[1]),high:parseFloat(l[2]),low:parseFloat(l[3]),close:parseFloat(l[4]),volume:parseInt(l[5]),amount:parseInt(l[6])}),0==o.length?(a.low=r.low,a.high=r.high):(a.low=Math.min(a.low,r.low),a.high=Math.max(a.high,r.high)),o.push(r)}return a.ks=o,a.dataLength=a.ks.length,a.updateTip=t.options.updateTip,a},getDataLength:function(){return this.dataLength},setDataLength:function(e){this.dataLength=e}};var fsCanvas=$id("canvasFS"),klCanvas=$id("canvasKL"),width_parent=fsCanvas.parentNode.clientWidth,height_parent=fsCanvas.parentNode.clientHeight*devicePixelRatio*.9,canvasWidth=width_parent,marginLeft=37.5,marginTop=.5,fsChartWidth=canvasWidth-2*marginLeft,klChartWidth=canvasWidth-marginLeft,canvasHeight=300;fsCanvas.style.width=canvasWidth+"px",fsCanvas.style.height=height_parent+"px",fsCanvas.height=height_parent*devicePixelRatio,fsCanvas.width=canvasWidth*devicePixelRatio,klCanvas.style.width=canvasWidth+"px",klCanvas.style.height=height_parent+"px",klCanvas.height=height_parent*devicePixelRatio,klCanvas.width=canvasWidth*devicePixelRatio;var xAxisHeight=20,chartHeight=.6*height_parent,temp=.4*height_parent,volumeHeight=temp-xAxisHeight,priceHeight=temp-volumeHeight-xAxisHeight,_fsChartRegion={x:marginLeft*devicePixelRatio,y:marginTop*devicePixelRatio,width:fsChartWidth*devicePixelRatio,height:chartHeight*devicePixelRatio},_klChartRegion={x:marginLeft*devicePixelRatio,y:marginTop*devicePixelRatio,width:klChartWidth*devicePixelRatio,height:.4*height_parent*devicePixelRatio},_fsVolumeRegion={x:marginLeft*devicePixelRatio,y:_fsChartRegion.y+_fsChartRegion.height+xAxisHeight*devicePixelRatio,height:volumeHeight*devicePixelRatio,width:(fsChartWidth-.5)*devicePixelRatio},_klVolumeRegion={x:marginLeft*devicePixelRatio,y:_klChartRegion.y+_klChartRegion.height+xAxisHeight*devicePixelRatio,height:.3*height_parent*devicePixelRatio,width:(klChartWidth-.5)*devicePixelRatio},fsOptions={canvas:fsCanvas,leftTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},rightTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},bottomTipSize:{width:35*devicePixelRatio,height:18*devicePixelRatio},backgroundColor:"#fff",riseColor:RiseColor,fallColor:FallColor,normalColor:"black",needPaintAvgPriceLine:!0,minsChart:{totalDotsCount:241,region:_fsChartRegion,priceLineColor:"rgb(48, 133, 213)",avgPriceLineColor:"rgb(241, 140, 79)",middleLineColor:"red",middleLineWidth:2*lineWidth,otherLineWidth:lineWidth,otherLineStyle:"lightgray",borderColor:"gray",horizontalLineCount:3,verticalLineCount:3,lineStyle:"dashed",yScalerLeft:{font:font+"px Arial",region:{x:.5,y:_fsChartRegion.y,width:marginLeft*devicePixelRatio,height:_fsChartRegion.height},align:"right",textBaseline:"top",fontHeight:font},yScalerRight:{font:font+"px Arial",region:{x:_fsChartRegion.width+_fsChartRegion.x,y:_fsChartRegion.y,width:marginLeft*devicePixelRatio,height:_fsChartRegion.height},align:"left",textBaseline:"top",fontHeight:font}},xScaler:{textBaseline:"top",font:font+"px Arial",color:"black",region:{x:_fsChartRegion.x,y:_fsChartRegion.y+_fsChartRegion.height,width:_fsChartRegion.width,height:xAxisHeight},data:["09:30","10:30","11:30/13:00","14:00","15:00"],fontHeight:font},volume:{region:_fsVolumeRegion,totalDotsCount:241,borderColor:"gray",splitLineColor:"lightgray",splitLineWidth:lineWidth,verticalLineCount:3,yScalerLeft:{font:font+"px Arial",region:{x:_fsVolumeRegion.x-marginLeft*devicePixelRatio,y:_fsVolumeRegion.y,width:_fsVolumeRegion.x,height:_fsVolumeRegion.height},color:"black",align:"right",textBaseline:"top",fontHeight:font},yScalerRight:{font:font+"px Arial",region:{x:_fsVolumeRegion.width+_fsVolumeRegion.x,y:_fsVolumeRegion.y,width:_fsVolumeRegion.x,height:_fsVolumeRegion.height},color:"black",align:"left",textBaseline:"top",fontHeight:font}},slider:{bar:{width:20,height:35,borderColor:"black",fillColor:"lightgray"},minBarDistance:20}},klOptions={leftTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},rightTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},bottomTipSize:{width:60*devicePixelRatio,height:18*devicePixelRatio},canvas:klCanvas,backgroundColor:"#fff",riseColor:RiseColor,fallColor:FallColor,normalColor:"black",region:_klChartRegion,barWidth:8*devicePixelRatio,spaceWidth:4*devicePixelRatio,horizontalLineCount:2,verticalLineCount:1,lineStyle:"dashed",borderColor:"gray",splitLineColor:"#eeeeee",circleColor:RiseColor,lineWidth:lineWidth,MAs:[{color:"rgb(255,70,251)",daysCount:5},{color:"rgb(227,150,34)",daysCount:10},{color:"rgb(53,71,107)",daysCount:20}],yAxis:{region:{x:.5,y:_klChartRegion.y,width:marginLeft*devicePixelRatio,height:_klChartRegion.height},font:font+"px Arial",color:"black",align:"right",fontHeight:font,textBaseline:"top"},xAxis:{region:{x:_klChartRegion.x/2,y:_klChartRegion.y+_klChartRegion.height,width:_klChartRegion.width+_klChartRegion.x/2,height:xAxisHeight},font:font+"px Arial",color:"black",align:"left",fontHeight:font,textBaseline:"top",scalerCount:2,height:xAxisHeight},volume:{region:_klVolumeRegion,lineWidth:lineWidth,horizontalLineCount:1,lineStyle:"dashed",yAxis:{region:{x:_klVolumeRegion.x-marginLeft*devicePixelRatio,y:_klVolumeRegion.y,width:_klVolumeRegion.x,height:_klVolumeRegion.height},font:font+"px Arial",color:"black",align:"right",fontHeight:font,textBaseline:"top"}},priceLine:{region:{x:marginLeft*devicePixelRatio,y:_klVolumeRegion.y+_klVolumeRegion.height,height:height_parent*devicePixelRatio-xAxisHeight*devicePixelRatio-_klVolumeRegion.height-_klChartRegion.height,width:_klVolumeRegion.width},verticalLineCount:5,horizontalLineCount:1,lineStyle:"dashed",borderColor:"#cccccc",splitLineColor:"#eeeeee",fillColor:"#a0d4f6",alpha:1,yAxis:{font:font+"px Arial",color:"black",align:"left",fontHeight:font,textBaseline:"top"}},slider:{bar:{width:20*devicePixelRatio,height:35*devicePixelRatio,borderColor:"gray",fillColor:"lightgray"},minBarDistance:20*devicePixelRatio}};klData.prototype={init:function(){var e,t=this,i="fq="+t.options.fq,a="p="+t.options.type,o="year="+t.options.time,n="info=k_sz_"+t.options.code+"&aid=1",r="http://qd.10jqka.com.cn/api.php",l=r+"?"+a+"&"+i+"&"+o+"&"+n;e&&document.removeChild(e),e=document.createElement("script"),e.src=l,e.onload=function(){var e=t.options.time,i=e.split(","),a=t.options.type,o="k";switch(a){case"stock_day":o+="_daily_";break;case"stock_week":o+="_week_";break;case"stock_month":o+="_month_";break;case"stock_min5":o+="_5_";break;case"stock_min15":o+="_15_";break;case"stock_min30":o+="_30_";break;case"stock_min60":o+="_60_"}if(o+=t.options.code,"stock_min5"==a||"stock_min15"==a||"stock_min30"==a||"stock_min60"==a){var n=t.parseData(window[o]);return void drawKL(null,n,t.kChartOptions)}result="";var n;if(1==i.length){result=result+o+"_"+e.substr(2,2);var n=t.parseData(window[result]);return void drawKL(null,n,t.kChartOptions)}for(var r=0;r<i.length;++r)result=1==i.length?result+o+"_"+i[r].substr(2,2):result+o+"_"+i[r].substr(2,2)+"+";result=result.substr(0,result.length-1);var l=result.split("+"),s="";for(r=0;r<l.length;++r)s+=window[l[r]];var n=t.parseData(s);drawKL(null,n,t.kChartOptions)},document.body.appendChild(e)},parseData:function(e){var t=this,i=e.split("|");i.pop();var a={},o=[];this.setDataLength(i.length);for(var n=0;n<i.length;n++){var r,l=i[n].split(",");if(0==l.length)break;var s;0==n?r={quoteTime:parseInt(l[0]),preClose:parseInt(0),open:parseFloat(l[1]),high:parseFloat(l[2]),low:parseFloat(l[3]),close:parseFloat(l[4]),volume:parseInt(l[5]),amount:parseInt(l[6])}:(s=i[n-1].split(","),r={quoteTime:parseInt(l[0]),preClose:parseFloat(s[4]),open:parseFloat(l[1]),high:parseFloat(l[2]),low:parseFloat(l[3]),close:parseFloat(l[4]),volume:parseInt(l[5]),amount:parseInt(l[6])}),0==o.length?(a.low=r.low,a.high=r.high):(a.low=Math.min(a.low,r.low),a.high=Math.max(a.high,r.high)),o.push(r)}return a.ks=o,a.dataLength=a.ks.length,a.updateTip=t.options.updateTip,a},getDataLength:function(){return this.dataLength},setDataLength:function(e){this.dataLength=e}};