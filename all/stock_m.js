//@charset "utf-8";
function convertDate(t,i){var e=Math.ceil(t/1e4)-1,o=t%100,n=(Math.ceil(t/100)-1)%100,a=new Date;if(a.setYear(e),a.setMonth(n-1),a.setDate(o),10>n&&(n="0"+n),10>o&&(o="0"+o),i){var s=["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"];return e+"-"+n+"-"+o+"ï¼Œ"+s[a.getDay()]}return e+"-"+n+"-"+o}function calcAxisValues(t,i,e,o){var n=t-i,a=n/(e-1),s=[];"undefined"==typeof o&&(o=toMoney);for(var r=0;e>r;++r){var h=toMoney(t-a*r);h>=1e4&&1e6>=h?h=h/1e4+"\u4E07":h>=1e6&&1e8>=h&&(h=h/1e6+"\u767E\u4E07"),s.push(h)}return s}function toMoney(t){return isNaN(t)?void 0:t.toFixed(2)}function calcMAPrices(t,i,e,o){for(var n=new Array,a=i;i+e>a;a++){var s=a-o+1;if(0>s)n.push(!1);else{for(var r=0,h=s;a>=h;h++)r+=t[h].close;var l=r/o;n.push(l)}}return n}function $id(t){return document.getElementById(t)}function getPriceColor(t,i){return i>=t?riseColor:t>i?fallColor:normalColor}function getColor(t){return t>=0?riseColor:fallColor}function setTouchEventOffsetPosition(t,i){t=t||event,t.touches&&t.touches.length?t=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(t=t.changedTouches[0]);var e=t.pageX-i.x,o=t.pageY-i.y;return console.log(t.pageX,t.pageY,i.x,i.y,e,o),{offsetX:e*devicePixelRatio,offsetY:o*devicePixelRatio}}function line(t){if(null!=t){var i=t.ctx,e=t.x0,o=t.y0,n=t.x1,a=t.y1,s=t.color,r=t.lineWidth;i.beginPath(),i.moveTo(e,o),i.lineTo(n,a),i.strokeStyle=s,i.lineWidth=r,i.stroke()}}function LinePainter(t){this.options=t}function Painter(t,i,e){this.canvas=$id(t),this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d"),this.data=e,this.paintImplement=i,this.width=this.canvas.width,this.height=this.canvas.height)}function VolumePainter(t){this.options=t;var i=t.region.width/t.totalDotsCount;this.barWidth=.5*i,this.spaceWidth=.5*i,this.barWidth*t.totalDotsCount>t.region.width&&(this.barWidth=Math.floor(t.region.width/t.totalDotsCount)+.5)}function xAxis(t){this.xOptions=t}function yAxis(t){this.scaleOptions=t}function Tip(t){extendObject(t,this),this.tipX=0,this.tipY=0}function CrossLines(t){this.updateOptions(t)}function Slider(t,i){this.canvas=t,this.relativePoint=getPageCoord(t),this.ctx=this.canvas.getContext("2d"),this.region=i.region,this.bar=i.bar,this.value=i.value,this.minBarDistance=i.minBarDistance,this.onPositionChanged=i.onPositionChanged,this.prePaint=i.prePaint,this.isTouchDevice=isTouchDevice(),this.calcPositions()}function FenshiChart(t){this.canvas=t.canvas,this.options=t,this.ctx=this.canvas.getContext("2d"),window.riseColor=t.riseColor,window.fallColor=t.fallColor,window.normalColor=t.normalColor}function kLine(t){this.options=t,this.dataRanges=null,this.canvas=t.canvas,this.MAS=new Array}function ChartTouchEvent(t,i){this.canvas=t,this.options=i}function cancleBubbleAndPreventDefault(t){t&&t.preventDefault&&t.preventDefault(),t.cancelBubble=!0}function addCrossLinesAndTipEvents(t,i){if(!t.lineEventInstance){var e=new ChartTouchEvent(t,i);t.lineEventInstance=e,t.lineEventInstance.addCrossLinesAndTipEvents()}}!function(){function t(){this.tapTimeLimit=500,this.devicePixelRatio=window.devicePixelRatio||1}t.prototype={isTouchDevice:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},toMoney:function(t){return t.toFixed(2)},bigNumberToText:function(t){var i,e=t/1e8;if(e>1)i=e.toFixed(2)+"\u4EBF";else{var o=t/1e4;i=o>1?o.toFixed(2)+"\u4E07":t}return i},addEvent:function(t,i,e,o){if(t.addEventListener)return t.addEventListener(i,e,o),!0;if(t.attachEvent){var n=t.attachEvent("on"+i,e);return n}t["on"+i]=e},getEventTarget:function(t){return t.srcElement||t.target||t.relatedTarget},$id:function(t){return document.getElementById(t)},getOffset:function(t){if(!isNaN(t.offsetX)&&!isNaN(t.offsetY))return t;var i=t.target;void 0==i.offsetLeft&&(i=i.parentNode);var e=getPageCoord(i),o={x:window.pageXOffset+t.clientX,y:window.pageYOffset+t.clientY};console.log(e,o,t);var n={offsetX:o.x-e.x,offsetY:o.y-e.y};return n},getPageCoord:function(t){for(var i={x:0,y:0};t;)i.x+=t.offsetLeft,i.y+=t.offsetTop,t=t.offsetParent;return i}},window.extendObject=function(t,i){for(var e in t)i[e]=t[e];return i},window.extendWindow=function(t){window.extendObject(t,window)};var i=new t;extendWindow(i)}();var dashSize=2,lineWidth=1,canvas_width=603,canvas_height=460,font=12*devicePixelRatio,RiseColor="rgb(252, 4, 4)",FallColor="rgb(0, 168, 0)";Array.prototype.each=function(t,i,e){i=i||0,e=e||this.length-1;for(var o=i;e>=o;o++)if(t(this[o],this,o),this.breakLoop){this.breakLoop=!1;break}},LinePainter.prototype={initialize:function(t){t.options=this.options,t.implement=this},start:function(){var t=this,i=t.ctx,e=t.options,o=e.region;i.save(),i.translate(o.x,o.y+o.height/2);var n=Math.abs(e.middleValue-e.maxPrice),a=Math.abs(e.middleValue-e.minPrice),s=Math.max(n,a);this.maxDiff=1.1*s,i.beginPath(),i.strokeStyle=e.lineColor},end:function(){this.ctx.stroke(),this.ctx.restore()},paintItem:function(t,i,e){var o=this.ctx;o.lineWidth=this.options.lineWidth,0==t?(o.moveTo(i,e),this.X=Math.floor(i)+.5,this.Y=Math.floor(e)+.5):o.lineTo(i,e),t==this.data.items.length-1&&this.options.isNeedFill&&(o.save(),o.lineWidth=this.options.lineWidth,o.strokeStyle=this.options.fillColor,o.lineTo(i,Math.floor(this.options.region.height/2)+.5),o.lineTo(this.X,Math.floor(this.options.region.height/2)+.5),o.fillStyle=this.options.fillColor,o.fill(),o.stroke(),o.restore())},getDataLength:function(){return this.options.getDataLength.call(this)},getX:function(t){return Math.floor(t*(this.options.region.width/this.options.totalDotsCount))+.5},getY:function(t){var i=this.options,e=i.getItemValue(this.data.items[t])-i.middleValue,o=e/this.maxDiff,n=o*i.region.height/2;return-n}},Painter.prototype={paint:function(){var t=(this.ctx,this.paintImplement);if("function"==typeof t.initialize&&t.initialize(this),t.start&&t.start.call(this),"function"==typeof t.paintItems)t.paintItems.call(this);else{var i;i=this.data.items?this.data.items.length:this.data.length;for(var e=0;i>e;e++){var o=t.getX?t.getX.call(this,e):void 0,n=t.getY?t.getY.call(this,e):void 0;t.paintItem.call(this,e,o,n)}}t.end&&t.end.call(this,this.data)},drawHLine:function(t,i,e,o,n,a){var s=this.ctx;if(s.strokeStyle=t,10*e%10==0&&(e+=.5),a&&"dashed"==a){var r=0;do this.drawHLine(t,r,e,dashSize,n),r+=2*dashSize;while(o>r)}else s.beginPath(),s.moveTo(i,e),s.lineTo(i+o,e),s.stroke()},drawVLine:function(t,i,e,o,n,a){var s=this.ctx;if(s.strokeStyle=t,10*i%10==0&&(i+=.5),a&&"dashed"==a){var r=0;do this.drawVLine(t,i,r,dashSize,n),r+=2*dashSize;while(o>r)}else s.beginPath(),s.moveTo(i,e),s.lineTo(i,e+o),s.stroke()},setData:function(t){this.data=t},setPaintImplement:function(t){this.paintImplement=t}},VolumePainter.prototype={initialize:function(t){t.options=this.options,t.barWidth=this.barWidth,t.spaceWidth=this.spaceWidth},getDataLength:function(){return this.options.getDataLength.call(this)},getX:function(t){return this.options.region.x+t*(this.barWidth+this.spaceWidth)+.5},start:function(){{var t=this.ctx,i=this.options;i.region}t.save();var e=0;this.data.items.each(function(t){e=Math.max(e,t.volume)}),this.maxVolume=e},end:function(){this.ctx.restore()},getY:function(t){var i=this.options.region.y+(this.maxVolume-this.data.items[t].volume)*this.options.region.height/this.maxVolume;return i},paintItem:function(t,i,e){var o,n=this.ctx;o=this.data.items[t].price>=this.data.items[t].preClose?window.riseColor:this.data.items[t].price<this.data.items[t].preClose?window.fallColor:window.normalColor,n.fillStyle=o,n.beginPath(),n.rect(i,e,this.barWidth,this.options.region.y+this.options.region.height-e),n.fill()}},xAxis.prototype={initialize:function(t){t.options=this.xOptions},start:function(){var t=this.ctx;t.save(),"string"==typeof this.options.color&&(t.fillStyle=this.options.color),t.font=this.options.font,this.options.textBaseline&&(t.textBaseline=this.options.textBaseline),t.translate(this.options.region.x+.5,this.options.region.y+.5)},getY:function(){return 0},getX:function(t){if(0==t)return 0;var i=this.ctx.measureText(this.data[t]).width;return t==this.data.length-1?this.options.region.width-i:this.options.region.width*t/(this.data.length-1)-i/2},paintItem:function(t,i,e){this.ctx.fillText(this.data[t],i,e)},end:function(){this.ctx.restore()}},yAxis.prototype={initialize:function(t){t.scaleOptions=this.scaleOptions},start:function(){var t=this.ctx;t.save(),"string"==typeof this.scaleOptions.color&&(t.fillStyle=this.scaleOptions.color),t.font=this.scaleOptions.font,this.scaleOptions.textBaseline&&(t.textBaseline=this.scaleOptions.textBaseline),t.translate(this.scaleOptions.region.x+.5,this.scaleOptions.region.y+.5)},end:function(){this.ctx.restore()},getX:function(t){if("left"==this.scaleOptions.align)return 0;var i=this.ctx.measureText(this.data[t]).width;return this.scaleOptions.region.width-i-5},getY:function(t){return 0==t?0:t==this.data.length-1?this.scaleOptions.region.height-this.scaleOptions.fontHeight:this.scaleOptions.region.height*t/(this.data.length-1)-this.scaleOptions.fontHeight/2},paintItem:function(t,i,e){"function"==typeof this.scaleOptions.color?this.ctx.fillStyle=this.scaleOptions.color(this.data[t]):"string"==typeof this.scaleOptions.color&&(this.ctx.fillStyle=this.scaleOptions.color),this.ctx.fillText(this.data[t],i,e)}},Tip.prototype={getElementId:function(){return this.canvas.id+"_tip"},show:function(t,i){t&&(this.crossPoint=t),i&&(this.innerHTML=i)},hide:function(){var t=$id(this.getElementId());t&&(t.style.display="none")},update:function(t,i){this.relativePoint=t,this.innerHTML=i,this.show()}},CrossLines.prototype={updateOptions:function(t){this.options=t,this.canvas=t.canvas,this.horizontalRange=t.horizontalRange,this.verticalRange=t.verticalRange,this.canvasPosition=getPageCoord(this.canvas),this.crossPoint=t.points.crossPoint,this.color=t.crossLinesColor,this.lineWidth=t.crossLineWidth||"1px",this.relative=t.relative},removeCrossLines:function(){var t=this.canvas,i=t.getContext("2d");i.clearRect(0,0,t.width,t.height)},updateCrossPoint:function(t){this.crossPoint=t,this.drawCrossLines()},drawCrossLines:function(){var t=this,i=t.canvas,e=t.horizontalRange,o=t.verticalRange,n=i.getContext("2d");n.clearRect(0,0,i.width,i.height),n.translate(i.x,i.y),t.options.points.averagePoint&&t._drawCircle(n,t.options.points.averagePoint),t.options.points.pricePoint&&t._drawCircle(n,t.options.points.pricePoint),t.options.points.volumePoint&&t._drawCircle(n,t.options.points.volumePoint),n.strokeStyle=t.color,n.lineWidth=t.lineWidth,n.beginPath(),n.moveTo(Math.floor(e.x1)+.5,Math.floor(this.crossPoint.y)+.5),n.lineTo(Math.floor(e.x2)+.5,Math.floor(this.crossPoint.y)+.5);var a,s,r;t.options.leftTipSize&&(a={ctx:n,posType:"left",fillStyle:"gray",strokeStyle:"red",font:font+"px Arial",text:t.crossPoint.text?t.crossPoint.text:t._getRelativeY(t.crossPoint.y),tfHeight:t.options.leftTipSize.height,tfWidth:t.options.leftTipSize.width,textBaseline:"top",devicePixelRatio:t.options.devicePixelRatio,point:{x:Math.floor(e.x1)+.5,y:Math.floor(t.crossPoint.y)+.5}},t._drawTextField(a)),t.options.rightTipSize&&(s={ctx:n,posType:"right",fillStyle:"gray",strokeStyle:"red",font:font+"px Arial",text:t._getPercent(t.crossPoint.y),tfHeight:t.options.rightTipSize.height,tfWidth:t.options.rightTipSize.width,textBaseline:"top",devicePixelRatio:t.options.devicePixelRatio,point:{x:e.x2,y:Math.floor(this.crossPoint.y)+.5}},t._drawTextField(s)),n.moveTo(Math.floor(this.crossPoint.x)+.5,o.y1),n.lineTo(Math.floor(this.crossPoint.x)+.5,o.y2),n.moveTo(Math.floor(this.crossPoint.x)+.5,o.y3),n.lineTo(Math.floor(this.crossPoint.x)+.5,o.y4),t.options.bottomTipSize&&(r={ctx:n,posType:"bottom",fillStyle:"gray",strokeStyle:"red",font:font+"px Arial",text:t.options.points.timeText,tfHeight:t.options.bottomTipSize.height,tfWidth:t.options.bottomTipSize.width,textBaseline:"top",devicePixelRatio:t.options.devicePixelRatio,point:{x:Math.floor(this.crossPoint.x)+.5,y:o.y2}},t._drawTextField(r)),n.closePath(),n.stroke()},_drawTextField:function(t){var i,e,o,n=t.tfHeight,a=t.tfWidth,s=t.ctx;s.save(),s.fillStyle=t.fillStyle,s.textBaseline=t.textBaseline,s.font=t.font;var r=t.posType,h=s.measureText(t.text).width;switch(r){case"left":i=t.point.x-a,o=t.point.x-h,e=t.point.y-n/2;break;case"right":i=t.point.x+3,o=i,e=t.point.y-n/2;break;case"bottom":this.canvas.width-t.point.x<=a/2?(i=this.canvas.width-a,o=this.canvas.width-h):(i=t.point.x-a/2,o=t.point.x-h/2),e=t.point.y+3}s.rect(i,e,a,n),s.fillRect(i,e,a,n),s.fillStyle="red",s.fillText(t.text,o,e)},_getRelativeY:function(t){var i=(this.relative.middleY-t)/this.relative.middleY,e=this.relative.preClose+this.relative.maxDiff*i;return parseFloat(e).toFixed(2)},_getPercent:function(t){var i=(this.relative.middleY-t)/this.relative.middleY,e=this.relative.preClose,o=e+this.relative.maxDiff*i,n=100*(o-e)/e;return n.toFixed(2)+"%"},_drawCircle:function(t,i){t.save(),t.strokeStyle=i.color,t.fillStyle=i.color,t.beginPath(),t.arc(i.x,i.y,3,0,2*Math.PI,!1),t.closePath(),t.fill(),t.restore()}},Slider.prototype={calcPositions:function(){var t=this.region.width-this.bar.width;this.leftPosition=Math.floor(this.value.left*t/100+this.bar.width/2)+.5,this.rightPosition=Math.floor(this.value.right*t/100+this.bar.width/2)+.5,"undefined"==typeof this.preValue&&(this.preValue=this.value)},drawSlider:function(){var t=(this.canvas,this.ctx);t.save();var i=this.region,e=this.bar,o=this.leftPosition,n=this.rightPosition;t.clearRect(i.x-1,i.y-1,i.width+1,i.height+1),t.translate(i.x-.5,i.y-.5),this.calcPositions(),"function"==typeof this.prePaint&&this.prePaint(t),t.lineWidth=lineWidth,t.strokeStyle=i.borderColor,t.beginPath(),t.moveTo(Math.floor(i.x+o)+.5,Math.floor(i.y+i.height)-.5),t.lineTo(Math.floor(i.x+o)+.5,Math.floor(i.y+i.height-(i.height-e.height)/2)-.5),t.stroke(),t.strokeStyle=i.borderColor,t.beginPath(),t.moveTo(Math.floor(i.x+o)+.5,Math.floor(i.y+(i.height-e.height)/2))+.5,t.lineTo(Math.floor(i.x+o)+.5,Math.floor(i.y)+.5),t.stroke(),t.strokeStyle=i.borderColor,t.beginPath(),t.moveTo(Math.floor(i.x+i.width)+.5,Math.floor(i.y)+.5),t.lineTo(Math.floor(i.x+i.width)+.5,Math.floor(i.y+i.height)-.5),t.stroke(),t.beginPath(),t.moveTo(Math.floor(i.x+n)+.5,Math.floor(i.y+i.height)-.5),t.lineTo(Math.floor(i.x+n)+.5,Math.floor(i.y+i.height-(i.height-e.height)/2)+.5),t.stroke(),t.strokeStyle=i.borderColor,t.beginPath(),t.moveTo(Math.floor(i.x+n)+.5,Math.floor(i.y)+.5),t.lineTo(Math.floor(i.x+n)+.5,Math.floor(i.y+(i.height-e.height)/2)+.5),t.stroke(),t.beginPath(),t.fillStyle=i.fillColor,t.globalAlpha=.3,t.rect(Math.floor(i.x+o)+.5,Math.floor(i.y)+.5,Math.floor(n-o)+.5,Math.floor(i.height)+.5),t.closePath(),t.fill(),t.globalAlpha=1,t.strokeStyle=e.borderColor,t.fillStyle=e.fillColor,t.beginPath();var a={x:i.x+o-e.width/2,y:i.y+(i.height-e.height)/2,width:e.width,height:e.height};t.rect(a.x,a.y,a.width,a.height),this.leftBarRegion=a,t.closePath(),t.stroke(),t.fill(),t.strokeStyle=e.borderColor,t.fillStyle=e.fillColor,t.beginPath();var s={x:i.x+n-e.width/2,y:i.y+(i.height-e.height)/2,width:e.width,height:e.height};t.rect(s.x,s.y,s.width,s.height),this.rightBarRegion=s,t.closePath(),t.stroke(),t.fill(),t.restore()},setLeftPosition:function(t){this.leftPosition=t<=this.bar.width/2?Math.floor(this.bar.width/2)+.5:this.rightPosition-this.minBarDistance-t>=this.bar.width?Math.floor(t)+.5:Math.floor(this.rightPosition-this.minBarDistance-this.bar.width)+.5,this.value=this.getValue()},setRightPosition:function(t){this.rightPosition=t<=this.leftPosition+this.bar.width+this.minBarDistance?this.leftPosition+this.bar.width+this.minBarDistance:t>=this.region.width-this.bar.width/2?this.region.width-this.bar.width/2:t,this.value=this.getValue()},addSliderEvents:function(){var t=this,i=isTouchDevice();i&&(addEvent(t.canvas,"touchend",function(i){t.onEndMove(i)}),addEvent(t.canvas,"touchmove",function(i){t.onTouchMove(i)}),addEvent(t.canvas,"touchstart",function(i){t.onStartHandle(i)}))},onEndMove:function(t){t=t||event,cancleBubbleAndPreventDefault(t);var i=this.canvas,e=getPageCoord(i),o=setTouchEventOffsetPosition(t,e);this._endMove(o);var n=new Date,a=n.getTime()-this.touchStartTime.getTime();200>a&&this.options.onClick&&"function"==typeof this.options.onClick&&addEvent(i,"click",options.onClick)},onStartHandle:function(t){t=t||event,cancleBubbleAndPreventDefault(t);var i=this.canvas,e=getPageCoord(i),o=setTouchEventOffsetPosition(t,e);this._startHandle(o),this.touchStartTime=new Date},onTouchMove:function(t){t=t||event,cancleBubbleAndPreventDefault(t);var i=this.canvas,e=getPageCoord(i),o=setTouchEventOffsetPosition(t,e);this._moveHandle(o)},_isInRegion:function(t,i){var e=t.offsetX>i.x&&t.offsetX<i.x+i.width&&t.offsetY>i.y&&t.offsetY<i.y+i.height;return e},_isBetweenLeftAndRight:function(t){var i=this.region,e={x:i.x+this.leftPosition+this.bar.width/2,y:i.y,width:this.rightPosition-this.leftPosition-this.bar.width,height:this.region.height};return this._isInRegion(t,e)},_isValueChanged:function(){var t=this.preValue,i=this.getValue(),e=Math.abs(i.left-t.left)+Math.abs(i.right-t.right);return this.preValue=i,0!=e},getValue:function(){var t=this.region.width-this.bar.width;return{left:100*(this.leftPosition-this.bar.width/2)/t,right:100*(this.rightPosition-this.bar.width/2)/t}},_isOnLeftBar:function(t){return this._isInRegion(t,this.leftBarRegion)},_isOnRightBar:function(t){return this._isInRegion(t,this.rightBarRegion)},_startHandle:function(t){var i=this;t=getOffset(t);var e=i._isOnLeftBar(t),o=i._isOnRightBar(t),n=i._isBetweenLeftAndRight(t);n?document.body.style.cursor="move":(e||o)&&(document.body.style.cursor="col-resize"),i.triggerBar=e?{type:"left",x:t.offsetX,position:i.leftPosition}:o?{type:"right",x:t.offsetX,position:i.rightPosition}:n?{type:"middle",x:t.offsetX,leftPosition:i.leftPosition,rightPosition:i.rightPosition}:null},_moveHandle:function(t){var i=this;t=getOffset(t);var e=i._isOnLeftBar(t),o=i._isOnRightBar(t),n=i._isBetweenLeftAndRight(t),a=i.triggerBar;if(n?document.body.style.cursor="move":(e||o||a)&&(document.body.style.cursor="col-resize"),a){a.targetX=t.offsetX;var s=a.targetX-a.x;"left"==a.type?(document.body.style.cursor="col-resize",i.setLeftPosition(a.position+s)):"right"==a.type?i.setRightPosition(a.position+s):(i.setLeftPosition(a.leftPosition+s),i.setRightPosition(a.rightPosition+s)),i.drawSlider()}},_endMove:function(t){t=getOffset(t);var i=this;i.triggerBar,i.triggerBar=null,document.body.style.cursor="default","function"==typeof i.onPositionChanged&&i._isValueChanged()&&(i.value=i.getValue(),i.onPositionChanged(i.value),i.preValue=i.getValue())}},FenshiChart.prototype={clearCanvas:function(){this.canvas.width+=0},paint:function(t){this.clearCanvas(),this.paintChart(t),this.paintXAxis(t),this.paintVolume(t)},paintChart:function(t){function i(i){if(i-=h.x,i>0){var e=Math.ceil(i/X),o=r.totalDotsCount;return e>=o&&(e=o-1),e>=t.mins.length&&(e=t.mins.length-1),e}return 0}function e(e,o){var n,a=i(e);a>=0&&a<t.mins.length&&("price"==o?n=t.mins[a].price:"average"==o&&(n=t.mins[a].average));var s=n-b,r=h.height/2,l=s/P.maxDiff,c=l*r;return r-c}function o(t){var e=i(t),o=h.x+X*e+.5*X;return parseInt(o)}function n(e){var o=i(e);o>=t.mins.length?o=t.mins.length-1:0>=o&&(o=0);var n,a,s=t.mins[o];0==t.quote.preClose?(n="-",a="-"):(n=(s.price-t.quote.preClose).toFixed(2),a=n/t.quote.preClose,a=(100*a).toFixed(2)+"%");var r={time:s.minute,preClose:s.preClose,price:s.price,average:s.average,zhangdie:n,zhangdiefu:a,volume:s.volume,maxPrice:t.quote.maxPrice,minPrice:t.quote.minPrice};T.options.updateTip(r)}function a(e){var o=i(e);o>=t.mins.length?o=t.mins.length-1:0>=o&&(o=0);var n=t.mins[o];return n.minute}function s(e){var o=i(e),n=0;t.mins.each(function(t){n=Math.max(n,t.volume)});var a=l.y+(n-t.mins[o].volume)*l.height/n;return a}var r=this.options.minsChart,h=r.region,l=this.options.volume.region,c=this.ctx;c.beginPath(),c.strokeStyle=r.borderColor,c.rect(h.x,h.y,Math.floor(h.width),h.height),c.stroke();for(var d=(r.horizontalLineCount+r.horizontalLineCount%2)/2,f=r.horizontalLineCount+1,g=1;g<=r.horizontalLineCount;++g){var u=g==d?r.middleLineWidth:r.otherLineWidth,v=g==d?r.middleLineStyle:r.otherLineStyle,p=h.y+h.height*g/f;p=Math.floor(p)+.5;var x={ctx:c,x0:h.x,y0:p,x1:h.x+h.width,y1:p,color:v,lineWidth:u};line(x)}f=r.verticalLineCount+1;for(var g=1;g<=r.verticalLineCount;++g){var y=h.x+h.width*g/f;y=Math.floor(y)+.5;var x={ctx:c,x0:y,y0:h.y,x1:y,y1:h.y+h.height,color:r.otherLineStyle,lineWidth:r.otherLineWidth};line(x)}var m={region:h,totalDotsCount:this.options.minsChart.totalDotsCount,getDataLength:function(){return this.data.items.length},getItemValue:function(t){return t.price},middleValue:t.quote.preClose,lineColor:r.priceLineColor,lineName:"priceLine",lineWidth:lineWidth,maxPrice:t.quote.maxPrice,minPrice:t.quote.minPrice},w=new LinePainter(m),P=new Painter(this.canvas.id,w,{items:t.mins});P.paint();var C=r.yScalerLeft,b=t.quote.preClose,T=this,L=getPageCoord(T.canvas);C.color=function(t){return t>b?riseColor:t==b?normalColor:fallColor};for(var M=[],S=[],k=b-P.maxDiff,R=2*P.maxDiff/(r.horizontalLineCount+1),g=r.horizontalLineCount+1;g>=0;g--){var W=k+g*R;M.push(W.toFixed(2));var z=100*(W-b)/b;S.push(z.toFixed(2)+"%")}var A=new yAxis(C),D=new Painter(this.canvas.id,A,M);D.paint();var O=r.yScalerRight;O.color=function(t){return"0.00%"==t?normalColor:parseFloat(t)<0?fallColor:riseColor};var E=new yAxis(O),I=new Painter(this.canvas.id,E,S);if(I.paint(),this.options.needPaintAvgPriceLine){var _=[];t.mins.each(function(t){_.push(t.average)}),m.lineColor=r.avgPriceLineColor,m.lineWidth=lineWidth,m.maxPrice=t.quote.maxPrice,m.getItemValue=function(t){return t},w=new LinePainter(m);var B=new Painter(this.canvas.id,w,{items:_});B.paint()}{var X=h.width/r.totalDotsCount,V=t.quote;Math.max(Math.abs(V.preClose-V.maxPrice))}if(null==T.mask){var F=T.canvas.id+"_mask",Y=$id(F),H=Y?!0:!1;H||(Y=document.createElement("canvas"),Y.id=F,T.canvas.parentNode.appendChild(Y)),Y.width=T.canvas.width,Y.height=T.canvas.height,Y.style.width=T.canvas.style.width,Y.style.height=T.canvas.style.height,Y.style.left=L.x+"px",Y.style.top=L.y+"px",Y.style.position="absolute",Y.style.zIndex=T.canvas.style.zIndex?T.canvas.style.zIndex+1:1,Y.style.display="block"}var q={leftTipSize:T.options.leftTipSize,rightTipSize:T.options.rightTipSize,bottomTipSize:T.options.bottomTipSize,relative:{middleY:h.height/2,maxDiff:P.maxDiff,preClose:b},getCrossPoint:function(t){var i={x:o(t.offsetX),y:e(t.offsetX,"price")},n={x:o(t.offsetX),y:e(t.offsetX,"price"),color:r.priceLineColor},h={x:o(t.offsetX),y:s(t.offsetX),color:r.priceLineColor},l={x:o(t.offsetX),y:e(t.offsetX,"average"),color:r.avgPriceLineColor},c=a(t.offsetX);return{crossPoint:i,pricePoint:n,averagePoint:l,volumePoint:h,timeText:c}},triggerEventRanges:{chartRegion:h,volumeRegion:l},crossLineWidth:lineWidth,tipOptions:{lineType:"stockminute",getTipHtml:function(t){return n(t.offsetX)},position:{x:20,y:10},region:h,size:{width:60,height:220},opacity:100,cssClass:""},crossLinesColor:"gray"};addCrossLinesAndTipEvents(Y,q)},paintVolume:function(t){var i=this.ctx,e=this.options.volume;i.beginPath(),i.strokeStyle=e.borderColor;var o=Math.floor(e.region.x)+.5,n=Math.floor(e.region.y)+.5;i.rect(o,n,Math.floor(e.region.width),Math.floor(e.region.height)-.5),i.stroke();var a=e.region,s={ctx:i,x0:a.x,y0:Math.floor(a.y+a.height/3)+.5,x1:a.width+a.x,y1:Math.floor(a.y+a.height/3)+.5,color:e.splitLineColor,lineWidth:e.splitLineWidth};line(s);var r={ctx:i,x0:a.x,y0:a.y+a.height/3*2,x1:a.width+a.x,y1:e.region.y+a.height/3*2,color:e.splitLineColor,lineWidth:e.splitLineWidth};line(r);for(var h=e.verticalLineCount+1,l=1;h>l;++l){var c=a.x+a.width*l/h;c=Math.floor(c)+.5;var d={ctx:i,x0:c,y0:a.y,x1:c,y1:a.y+a.height,color:e.splitLineColor,lineWidth:e.splitLineWidth};line(d)}e.getDataLength=function(){return this.data.items.length};var f=new VolumePainter(e),g=new Painter(this.canvas.id,f,{items:t.mins});g.paint();var u,v=g.maxVolume;v/1e6>100?(v/=1e6,u="0(\u4E07)"):v/1e4>100?(v/=1e4,uint="0(\u767E)"):(v/=100,uint="0(\u624B)");var p=[v.toFixed(0),(v/3*2).toFixed(0),(v/3).toFixed(0)];p.push(uint);var x=new yAxis(e.yScalerLeft),y=new Painter(this.canvas.id,x,p);y.paint();var m=new yAxis(e.yScalerRight);yAxisPainterR=new Painter(this.canvas.id,m,p),yAxisPainterR.paint()},paintXAxis:function(){var t=this.options.xScaler,i=new xAxis(t),e=new Painter(this.canvas.id,i,t.data);e.paint()},paintPriceLine:function(t){var i=this,e=i.options.priceLine;e.isNeedFill=!0,e.getDataLength=function(){return i.data.items.length},e.getItemValue=function(t){return t.price},e.maxPrice=t.quote.maxPrice,e.minPrice=t.quote.minPrice,e.lineWidth=lineWidth,e.middleValue=t.quote.preClose,e.totalDotsCount=i.options.minsChart.totalDotsCount;var o=e.region,n=this.ctx;n.beginPath(),n.strokeStyle=e.borderColor,n.rect(Math.floor(o.x)+.5,Math.floor(o.y)+.5,Math.floor(o.width),Math.floor(o.height)),n.stroke();var a=new LinePainter(e),s=new Painter(this.canvas.id,a,{items:t.mins});if(s.paint(),null==i.slider){var r=i.options.slider,h=canvas.id+"_slider",l=$id(h),c=l?!0:!1;c||(l=document.createElement("canvas"),l.id=h,document.body.appendChild(l));var d=e.region;l.width=d.width/devicePixelRatio,l.height=d.height/devicePixelRatio;var f=getPageCoord(i.canvas);l.x=(f.x+d.x)/devicePixelRatio,l.y=(f.y+d.y)/devicePixelRatio,l.style.left=f.x+d.x+"px",l.style.top=f.y+d.y/devicePixelRatio+"px",l.style.position="absolute",l.style.zIndex=i.canvas.style.zIndex?i.canvas.style.zIndex+1:1,l.style.display="block",i.dataRanges||(i.dataRanges={start:0,to:100});var g={region:{x:0,y:0,width:l.width,height:l.height,fillColor:"#a0d4f6"},bar:{width:10,height:35,borderColor:"green",fillColor:"orange"},value:{left:i.dataRanges.start,right:i.dataRanges.to},minBarDistance:r.minBarDistance||20,onPositionChanged:function(e){drawFs(t,{start:e.left,to:e.right}),i.slider.drawSlider()},prePaint:function(){},touchFaultTolerance:20},u=new Slider(l,g);this.slider=u,u.drawSlider(),u.addSliderEvents()}}},kLine.prototype={initialize:function(t){t.klOptions=this.options,t.implement=this},start:function(){var t=this.canvas,i=this.ctx;this.painting=!0;var e=this.klOptions;i.lineWidth=e.lineWidth;var o={width:t.width,height:t.height};i.clearRect(0,0,o.width*devicePixelRatio,o.height),i.save(),window.riseColor=e.riseColor,window.fallColor=e.fallColor,window.normalColor=e.normalColor,e.backgroundColor&&!this.drawnBackground&&(i.beginPath(),i.fillStyle=e.backgroundColor,i.rect(0,0,o.width,o.height),i.fill(),this.drawnBackground=!0),i.translate(e.region.x,e.region.y),i.strokeStyle=e.borderColor,i.beginPath(),i.rect(0,0,e.region.width,e.region.height),i.stroke();var n=e.region.height/(e.horizontalLineCount+1);n=n.toFixed(0);for(var a=1;a<=e.horizontalLineCount;a++){var s=n*a;s=Math.floor(s)+.5,this.drawHLine(e.splitLineColor,0,s,e.region.width,e.lineWidth,e.lineStyle)}for(var r=e.region.width/(e.verticalLineCount+1),a=1;a<=e.verticalLineCount;a++){var h=r*a;h=Math.floor(h)+.5,this.drawVLine(e.splitLineColor,h,0,e.region.height,e.lineWidth,e.lineStyle)}},end:function(){function t(t){var e=i(t);e>=s.data.ks.length?e=s.data.ks.length-1:0>=e&&(e=0);var o=s.data.ks[e];return convertDate(o.quoteTime,!1)}function i(t){if(t-=h.x,t>0){var i=r.spaceWidth+r.barWidth;t-=.5*i;var e=Math.floor(t/i),o=s.toIndex-s.startIndex+1;return e>=o&&(e=o-1),e+=s.startIndex}return 0}function e(t){var e=i(t);e-=s.startIndex;var o=h.x+(r.spaceWidth+r.barWidth)*(e+.5);return o}function o(t){var e=i(t),o=s.data.ks[e],n=o.low;return(s.high-n)*h.height/(s.high-s.low)}function n(t){var e=i(t),o=s.data.ks[e];return o.close}function a(t){var e=i(t);e>=s.data.ks.length?e=s.data.ks.length-1:0>=e&&(e=0);var o,n,a=s.data.ks[e],r=i(t)-s.startIndex,h=s.MA5[r],l=s.MA10[r],c=s.MA20[r];0==a.preClose?(o="-",n="-"):(o=(a.close-a.preClose).toFixed(2),n=o/a.preClose,n=(100*n).toFixed(2)+"%");var d={price:s.data.ks[s.data.dataLength-1].close,date:a.quoteTime,preClose:a.preClose,open:a.open,high:a.high,low:a.low,close:a.close,zhangdie:o,zhangdiefu:n,MA5:h,MA10:l,MA20:c,volume:a.volume,amount:a.amount,maxPrice:s.data.high,minPrice:s.data.low};s.data.updateTip(d)}this.ctx.restore();for(var s=this,r=s.klOptions,h=r.region,l=r.volume.region,c=this.canvas,d=getPageCoord(c),f={leftTipSize:r.leftTipSize,rightTipSize:r.rightTipSize,bottomTipSize:r.bottomTipSize,relative:{middleY:h.height/2,maxDiff:s.high,preClose:(s.high+s.low)/2},getCrossPoint:function(i){var a={x:e(i.offsetX),y:o(i.offsetX),text:n(i.offsetX)},s={x:e(i.offsetX),y:o(i.offsetX),color:r.circleColor},h=t(i.offsetX);return{crossPoint:a,pricePoint:s,timeText:h}},triggerEventRanges:{chartRegion:h,volumeRegion:l},tipOptions:{getTipHtml:function(t){return a(t.offsetX)},position:{x:20,y:20},region:h,size:{width:120,height:160},opacity:100,cssClass:""},crossLinesColor:"black"},g=[],u=s.data.ks.length,v=s.startIndex;v<=s.toIndex&&u>v;v++)g.push(s.data.ks[v]);var p,x;if(g.each(function(t,i,e){0==e?(p=t.high,x=t.low):(p=Math.max(t.high,p),x=Math.min(x,t.low))}),s.high=p,s.low=x,null==s.mask){var y=s.canvas.id+"_mask",m=$id(y),w=m?!0:!1;w||(m=document.createElement("canvas"),m.id=y,c.parentNode.appendChild(m)),m.width=s.canvas.width,m.height=s.canvas.height,m.style.width=s.canvas.style.width,m.style.height=s.canvas.style.height,m.style.left=d.x+"px",m.style.top=d.y+"px",m.style.position="absolute",m.style.zIndex=s.canvas.style.zIndex?s.canvas.style.zIndex+1:1,m.style.display="block"}addCrossLinesAndTipEvents(m,f);var P=r.priceLine.region,d=getPageCoord(s.canvas);if(null==s.slider){s.implement.paintPriceLine.call(s);var C=r.slider,y=c.id+"_slider",b=$id(y),w=b?!0:!1;w||(b=document.createElement("canvas"),b.id=y,c.parentNode.appendChild(b)),b.width=P.width,b.height=P.height,b.style.width=P.width/devicePixelRatio+"px",b.style.height=P.height/devicePixelRatio+"px",b.style.left=d.x+P.x/devicePixelRatio+"px",b.style.top=d.y+P.y/devicePixelRatio+"px",b.style.position="absolute",b.style.zIndex=s.canvas.style.zIndex?s.canvas.style.zIndex+2:1,b.style.display="block";var T={region:{x:0,y:0,width:P.width,height:P.height,fillColor:"#a0d4f6"},bar:r.slider.bar,value:{left:s.dataRanges.start,right:s.dataRanges.to},minBarDistance:C.minBarDistance||40,onPositionChanged:function(t){drawKL({start:t.left,to:t.right}),s.slider.drawSlider()},prePaint:function(){},touchFaultTolerance:20},L=new Slider(b,T);this.slider=L,L.drawSlider(),L.addSliderEvents()}},paintItems:function(){function t(){return(o.spaceWidth+o.barWidth)*g<=a.width}function i(t){var i=(w.high-t)*a.height/(w.high-w.low);return Math.floor(i)+.5}function e(t){var i=t*(o.spaceWidth+o.barWidth)+.5*(o.spaceWidth+o.barWidth);return i=Math.floor(i)+.5}var o=this.klOptions,n=this.ctx,a=o.region;n.lineWidth=o.lineWidth,n.translate(.5,a.y);var s=this.data.ks.length,r=!0;if(null==this.dataRanges){var h=Math.floor(a.width/(o.spaceWidth+o.barWidth));h>s&&(h=s),this.dataRanges={start:100*(this.data.ks.length-h)/this.data.ks.length,to:100},r=!1}var l=this.dataRanges,c=Math.floor(l.start/100*s),d=c-1>=0?c:0,f=Math.floor(l.to/100*s);f==s&&(f=s-1),this.startIndex=d,this.toIndex=f;var g=f-d+1;if(r){var u,v;t()?(u=1,v=(a.width-u*g)/g,v>6&&(u=4,v=(a.width-u*g)/g)):(u=1,v=(a.width-u*g)/g,3>=v&&v>=1?(u=1,v=(a.width-u*g)/g):v>6&&(u=4,v=(a.width-u*g)/g)),o.barWidth=v,o.spaceWidth=u}for(var p=[],x=d;f>=x&&s>x;x++)p.push(this.data.ks[x]);var y,m;p.each(function(t,i,e){0==e?(y=t.high,m=t.low):(y=Math.max(t.high,y),m=Math.min(m,t.low))}),this.high=y,this.low=m;var n=this.ctx,w=this;this.implement.paintMAs.call(this,p,i);var P=0,C=o.barWidth>1.5,b=o.region.width/p.length;b>=o.barWidth+o.spaceWidth&&(o.barWidth=2*b/3,o.spaceWidth=b/3);var T=function(t,a,s){var r=t.close>t.open,h=r?riseColor:fallColor,l=e(s);if(0==P)P=l;else if(1>l-P)return;P=l;var c=i(t.high),d=i(t.low);if(C){n.fillStyle=h,n.strokeStyle=h;var f,g;r?(f=i(t.close),g=i(t.open)-f):(f=i(t.open),g=i(t.close)-f),n.beginPath(),n.moveTo(l,c),n.lineTo(l,d),n.stroke();var u=Math.floor(l-o.barWidth/2)+.5;n.beginPath(),n.fillRect(u,f,o.barWidth,g)}else n.strokeStyle=h,n.beginPath(),n.moveTo(l,c),n.lineTo(l,d),n.stroke()};
p.each(T),this.filteredData=p,n.restore();var L=o.yAxis,M=new yAxis(L),S=calcAxisValues(y,m,o.horizontalLineCount+2),k=new Painter(this.canvas.id,M,S);k.paint();var R=o.xAxis,W=new xAxis(R),z=[],A=p.length/(o.verticalLineCount+1);1>A&&(o.xAxis.scalerCount=p.length,A=1),z.push(convertDate(p[0].quoteTime,!1).substr(2));for(var x=1;x<o.verticalLineCount+2;x++){var D=Math.ceil(x*A);D>=p.length&&(D=p.length-1);var O=convertDate(p[D].quoteTime,!1);O=O.substr(2),z.push(O)}var E=new Painter(this.canvas.id,W,z);E.paint(),n.restore(),this.implement.paintVolume.call(this,p),this.implement.paintPriceLine.call(this)},paintMAs:function(t,i){var e=this.ctx,o=this.klOptions,n=o.MAs,a=this;n.each(function(i){var e=calcMAPrices(a.data.ks,a.startIndex,t.length,i.daysCount);i.values=e,a["MA"+i.daysCount]=e,e.each(function(t){t&&(a.high=Math.max(a.high,t),a.low=Math.min(a.low,t))})}),n.each(function(t){var n=t.values;e.strokeStyle=t.color,e.beginPath();n.each(function(t,n,a){var s=a*(o.spaceWidth+o.barWidth)+.5*(o.spaceWidth+o.barWidth);if(t){var r=i(t);r&&0==a?e.moveTo(s,r):e.lineTo(s,r)}}),e.stroke()})},paintPriceLine:function(){function t(t){return t*n.width/f}function i(t){return(c.high-t)*n.height/(c.high-c.low)}var e=this.ctx;e.lineWidth=this.klOptions.lineWidth;var o=this.klOptions.priceLine,n=o.region;e.save(),e.translate(n.x,n.y),e.clearRect(0,0,n.width,n.height),e.rect(n.x,n.y,n.width,n.height);for(var a=(n.height/(o.horizontalLineCount+1)).toFixed(0),s=1;s<=o.horizontalLineCount;s++){var r=a*s;10*r%10==0&&(r+=.5),this.drawHLine(o.splitLineColor,0,r,n.width,this.klOptions.lineWidth,o.lineStyle)}for(var h=(n.width/(o.verticalLineCount+1)).toFixed(0),s=1;s<=o.verticalLineCount;s++){var l=h*s;10*l%10==0&&(l+=.5),this.drawVLine(o.splitLineColor,l,0,n.height,this.klOptions.lineWidth,o.lineStyle)}var c,d=this.data.ks,f=d.length;d.each(function(t,i,e){0==e?c={high:t.high,low:t.low}:(c.high=Math.max(c.high,t.close),c.low=Math.min(c.low,t.close))}),c.low>1&&(c.low-=1);var g=0;d.each(function(o,n,a){var s=t(a);if(0==g)g=s;else if(1>s-g)return;g=s;var r=i(o.close);0==a?(e.beginPath(),e.moveTo(s,r)):e.lineTo(s,r)}),e.stroke(),e.strokeStyle=o.borderColor,e.lineTo(n.width,n.height),e.lineTo(0,n.height),e.stroke(),e.fillStyle=o.fillColor,e.globalAlpha=o.alpha,e.fill(),e.beginPath(),e.rect(0,0,n.width,n.height),e.stroke(),e.closePath();var u=o.yAxis;u.region=u.region||{x:n.x,y:n.y,height:n.height,width:n.width};var v=new yAxis(u),p=calcAxisValues(c.high,c.low,o.horizontalLineCount+2),x=new Painter(this.canvas.id,v,p);x.paint(),e.restore()},paintVolume:function(t){function i(t){return s.height-s.height/f*t}function e(t){var i=t*(n.spaceWidth+n.barWidth)+.5*n.spaceWidth;return i=Math.round(i)+.5}var o=this.ctx,n=this.klOptions,a=n.volume,s=a.region;o.save(),o.translate(s.x,s.y),o.globalAlpha=1;for(var r=s.height/(a.horizontalLineCount+1),h=1;h<=a.horizontalLineCount;h++){var l=r*h;10*l%10==0&&(l+=.5),this.drawHLine(n.splitLineColor,0,l,n.region.width,n.lineWidth,n.lineStyle)}for(var c=n.region.width/(n.verticalLineCount+1),h=1;h<=n.verticalLineCount;h++){var d=c*h;10*d%10==0&&(d+=.5),this.drawVLine(n.splitLineColor,d,0,s.height,n.lineWidth,n.lineStyle)}o.strokeStyle=n.borderColor,o.beginPath(),o.rect(0,0,s.width,s.height),o.stroke();var f=0;t.each(function(t){f=Math.max(f,t.volume)}),f*=1.1,o.globalAlpha=1,t.each(function(t,a,r){var h=e(r),l=i(t.volume);o.beginPath(),o.rect(h,l,n.barWidth,s.height/f*t.volume),o.fillStyle=t.close>t.open?riseColor:fallColor,o.fill()}),o.restore();var g,u;1e6>f?(g=1e4,u="\u4E07\u624B"):(g=1e6,u="\u767E\u4E07\u624B");for(var v=[],p=f/(a.horizontalLineCount+1),h=0;h<a.horizontalLineCount+1;++h){var x=((f-p*h)/g).toFixed(0);v.push(x)}v.push(u);var y=a.yAxis,m=new yAxis(y),w=new Painter(this.canvas.id,m,v);w.paint(),o.restore()}},ChartTouchEvent.prototype={_removeCrossLinesAndTip:function(){var t=this;t.tip&&t.tip.hide(),t.crossLines&&t.crossLines.removeCrossLines()},updateOptions:function(t){this.options=t},_touchStart:function(t){t=t||event,cancleBubbleAndPreventDefault(t),this.touchStartTime=new Date},_touchMove:function(t){t=t||event,cancleBubbleAndPreventDefault(t);var i=this.canvas,e=getPageCoord(i),o=setTouchEventOffsetPosition(t,e);this._onTouchMove(o)},_touchEnd:function(t){t=t||event,cancleBubbleAndPreventDefault(t);{var i=this.canvas,e=getPageCoord(i);setTouchEventOffsetPosition(t,e)}this._removeCrossLinesAndTip();var o=new Date,n=o.getTime()-this.touchStartTime.getTime();200>n&&"function"==typeof this.options.onClick},_onTouchMove:function(t){var t=t||event;t=getOffset(t);var i=this,e=i.canvas,o=i.options,n=(getPageCoord(e),o.triggerEventRanges);if(t.offsetX<=n.chartRegion.x||t.offsetX>=n.chartRegion.x+n.width||t.offsetY<=n.chartRegion.y||t.offsetY>=n.volumeRegion.y+n.volumeRegion.height)return void i._removeCrossLinesAndTip();var a=o.getCrossPoint(t),s={relative:o.relative,points:a,horizontalRange:{x1:n.chartRegion.x,x2:n.chartRegion.x+n.chartRegion.width},verticalRange:{y1:n.chartRegion.y,y2:n.chartRegion.y+n.chartRegion.height,y3:n.volumeRegion.y,y4:n.volumeRegion.y+n.volumeRegion.height},crossLinesColor:o.crossLinesColor,crossLineWidth:o.crossLineWidth,leftTipSize:o.leftTipSize,rightTipSize:o.rightTipSize,bottomTipSize:o.bottomTipSize,canvas:e,devicePixelRatio:devicePixelRatio};if(i.crossLines)i.crossLines.updateOptions(s);else{var r=new CrossLines(s);i.crossLines=r}if(i.crossLines.drawCrossLines(),o.tipOptions){var h=o.tipOptions;if(!i.tip){var l={position:h.position,region:h.region,crossPoint:a,size:h.size,opacity:h.opacity,cssClass:h.cssClass,canvas:e,innerHTML:h.getTipHtml(t)},c=new Tip(l);i.tip=c}i.tip.show(a,h.getTipHtml(t))}},addCrossLinesAndTipEvents:function(){{var t=this,i=this.canvas;this.options,getPageCoord(i)}if(1!=i.addCrossLinesAndTipEvents){i.addCrossLinesAndTipEvents=!0;var e=isTouchDevice();e&&(addEvent(i,"touchstart",function(i){t._touchStart(i)}),addEvent(i,"touchmove",function(i){t._touchMove(i)}),addEvent(i,"touchend",function(i){t._touchEnd(i)}))}}};