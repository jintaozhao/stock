//@charset "utf-8";
function drawFs(e,t,i){var a;fenshiPainter||(a=new FenshiChart(t,i)),a.paint(e)}function FenshiData(e,t){this.options=e,this.fsOptions=t,this.chart=null;var i="vm_",a=this.options.code;("1"==a.substr(0,1)||"399"==a.substr(0,3)||"8"==a.substr(0,1))&&(this.fsOptions.needPaintAvgPriceLine=!1),this.needPaintAvgPriceLine=this.fsOptions.needPaintAvgPriceLine;var o=a.substr(0,1);i+="6"==o||"9"==o?"sh_":"0"==o||"2"==o||"3"==o?"sz_":"sh_",i+=a,this.url="http://qd.10jqka.com.cn/api.php?info="+i,this.refresh(this.url,i)}function realBack(e){var t=e.data[fsDataOptions.code];dataObject.quote.turnover=parseFloat(t[1968584]),dataObject.quote.volume=(t[13]/100).toFixed(0),drawFs(dataObject,fsOptions,fsDataOptions)}function drawKL(e,t,i){if(!painter){var a=new kLine(i);painter=new Painter(i.canvas.id,a,t)}painter.dataRanges=e,painter.paint()}function klData(e,t){this.options=e,this.kChartOptions=t}function dataReturn(e){for(var t=e.data,i={},a=[],o=0;o<t.length;o++){var n=t[o],r=String(n.date).replace(/-/g,""),l={code:n.code,quoteTime:r,preClose:parseFloat(n[6]),open:parseFloat(n[7]),high:parseFloat(n[8]),low:parseFloat(n[9]),close:parseFloat(n[11]),volume:Math.round(parseInt(n[13]/100)),amount:parseInt(n[19]),turnover:parseFloat(n[1968584])};0==a.length?(i.low=l.low,i.high=l.high):(i.low=Math.min(i.low,l.low),i.high=Math.max(i.high,l.high)),"20140520"==r&&console.log(l),l.open>0&&a.push(l)}i.ks=a,i.dataLength=i.ks.length,i.name=e.info[klDataOptions.code].name,dataObject=i;var h;realUrl="http://qd.10jqka.com.cn/quote.php?cate=real&type=stock&code="+klDataOptions.code+"&return=json&callback=realReturn",h&&document.removeChild(h),h=document.createElement("script"),h.src=realUrl,document.body.appendChild(h)}function realReturn(e){var t=e.data[klDataOptions.code],i=new Date,a=i.getMonth()+1>9?i.getMonth()+1:"0"+(i.getMonth()+1),o=i.getDate()>9?i.getDate():"0"+i.getDate(),n=i.getFullYear()+a+o,r={code:klDataOptions.code,quoteTime:n,preClose:parseFloat(t[6]),open:parseFloat(t[7]),high:parseFloat(t[8]),low:parseFloat(t[9]),close:parseFloat(parseFloat(t[11])?t[11]:t[7]),volume:parseInt(t[13]/100).toFixed(0),amount:parseInt(t[19]),turnover:parseFloat(t[1968584])},l=dataObject.ks.length;dataObject.ks[l-1].quoteTime!=r.quoteTime&&dataObject.ks.push(r),drawKL(null,dataObject,klOptions)}var fenshiPainter,dataObject={};FenshiData.prototype={getToday:function(){var e=new Date;return e.getDay()},init:function(){var e=this,t=code.substr(0,1);"6"==t||"9"==t?info+="sh_":("0"==t||"2"==t||"3"==t)&&(info+="sz_"),info+=code,e.refresh(e.url,info)},stopRefresh:function(e){clearTimeout(e)},refresh:function(e,t){var i,a=this,o=a.getToday();(6==o||1==o)&&a.stopRefresh(a.t),a.t=setTimeout(function(){a.refresh(a.url,t)},a.options.duration),i&&document.body.removeChild(i),i=document.createElement("script"),i.src=e,i.onload=function(){var e,i=t,o=a.parseData(window[i]),n=o.mins,r=a.getAxisMaxAndMin(n);n.length>0&&(e={quote:{date:o.day,preClose:o.preClose,minute:n[n.length-1].minute,price:n[n.length-1].price,volume:n[n.length-1].volume,average:n[n.length-1].average,minPrice:r.yMin,maxPrice:r.yMax},mins:n}),a.options.updateTip&&(a.fsOptions.updateTip=a.options.updateTip),dataObject=e;var l;realUrl="http://qd.10jqka.com.cn/quote.php?cate=real&type=stock&code="+fsDataOptions.code+"&return=json&callback=realBack",l&&document.removeChild(l),l=document.createElement("script"),l.src=realUrl,document.body.appendChild(l)},document.body.appendChild(i)},formatTime:function(e){if("string"==typeof e&&null!=e){var t=e.substr(e.length-2,2),i=e.substr(0,2);return i+":"+t}},parseData:function(e){for(var t=e.split("|")[1],i=t.split("~"),a=i[0],o=parseFloat(i[1]),n=i[2].split(";"),r=[],l=0;l<n.length;l++){var h=n[l].split(","),s={minute:this.formatTime(h[0]),price:parseFloat(isNaN(parseFloat(h[1]))?h[2]:h[1]),average:parseFloat(isNaN(parseFloat(h[2]))?h[1]:h[2]),volume:parseFloat(h[3]/100),preClose:o};r.push(s)}return{day:a,preClose:o,mins:r}},getAxisMaxAndMin:function(e){for(var t=[],i=[],a=[],o=0;o<e.length;++o)t.push(e[o].minute),i.push(Number(e[o].price)),a.push(Number(e[o].average));var n=Math.min.apply(null,i),r=Math.min.apply(null,a),l=Math.max.apply(null,i),h=Math.max.apply(null,a);return this.needPaintAvgPriceLine?{xMin:t[0],xMax:t[t.length-1],yMin:Math.min(n,r),yMax:Math.max(l,h)}:{xMin:t[0],xMax:t[t.length-1],yMin:Math.round(n),yMax:Math.round(l)}},calcTimeDelta:function(e,t){if(e&&t){var i=e.substr(e.length-2,2),a=e.substr(0,2),o=60*parseInt(a)+parseInt(i),n=t.substr(t.length-2,2),r=t.substr(0,2),l=60*parseInt(r)+parseInt(n);return Math.abs(l-o)}},calcLastTime:function(e){if(e){var t=parseInt(e.substr(e.length-2,2)),i=parseInt(e.substr(0,2)),a=t+1;a>=60&&(a-=60,i+=1),i=10>i?"0"+i:i;var o=i.toString()+t.toString();return o}}};var painter;klData.prototype={init:function(){var e,t=this,i="http://qd.10jqka.com.cn/quote.php?type=stock&cate=history&name=real&code="+t.options.code+"&start="+t.options.start+"&return=json&callback=dataReturn";e&&document.removeChild(e),e=document.createElement("script"),e.src=i,document.body.appendChild(e)}};var dataObject={},fsCanvas=$id("canvasFS"),klCanvas=$id("canvasKL"),width_parent=fsCanvas.parentNode.clientWidth,height_parent=290,canvasWidth=width_parent,marginLeft=40,marginRight=46,marginTop=0,fsChartWidth=canvasWidth-marginLeft-marginRight,klChartWidth=canvasWidth-marginRight-.5;fsCanvas.style.width=canvasWidth+"px",fsCanvas.style.height=height_parent+1+"px",fsCanvas.height=height_parent*devicePixelRatio,fsCanvas.width=canvasWidth*devicePixelRatio,klCanvas.style.width=canvasWidth+"px",klCanvas.style.height=height_parent+"px",klCanvas.height=height_parent*devicePixelRatio,klCanvas.width=canvasWidth*devicePixelRatio;var xAxisHeight=20,chartHeight=Math.floor(.6*height_parent),temp=height_parent-chartHeight,volumeHeight=temp-xAxisHeight,_fsChartRegion={x:marginLeft*devicePixelRatio+.5,y:marginTop*devicePixelRatio,width:fsChartWidth*devicePixelRatio,height:chartHeight*devicePixelRatio},_klChartRegion={x:marginLeft*devicePixelRatio+.5,y:marginTop*devicePixelRatio,width:klChartWidth*devicePixelRatio,height:chartHeight*devicePixelRatio-.5},_fsVolumeRegion={x:marginLeft*devicePixelRatio+.5,y:_fsChartRegion.y+_fsChartRegion.height+xAxisHeight*devicePixelRatio-.5,height:volumeHeight*devicePixelRatio,width:fsChartWidth*devicePixelRatio},_klVolumeRegion={x:marginLeft*devicePixelRatio+.5,y:_klChartRegion.y+_klChartRegion.height+xAxisHeight*devicePixelRatio-1,height:volumeHeight*devicePixelRatio,width:klChartWidth*devicePixelRatio},fsOptions={canvas:fsCanvas,leftTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},rightTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},bottomTipSize:{width:35*devicePixelRatio,height:18*devicePixelRatio},backgroundColor:"#fff",riseColor:RiseColor,fallColor:FallColor,normalColor:"black",needPaintAvgPriceLine:!0,minsChart:{totalDotsCount:242,region:_fsChartRegion,priceLineColor:"rgb(48, 133, 213)",avgPriceLineColor:"rgb(241, 140, 79)",middleLineStyle:"gray",middleLineWidth:lineWidth,otherLineWidth:lineWidth,otherLineStyle:"lightgray",borderColor:"gray",horizontalLineCount:3,verticalLineCount:3,lineStyle:"dashed",yScalerLeft:{font:font+"px Arial",region:{x:.5,y:_fsChartRegion.y,width:marginLeft*devicePixelRatio,height:_fsChartRegion.height},align:"right",textBaseline:"top",fontHeight:font},yScalerRight:{font:font+"px Arial",region:{x:_fsChartRegion.width+_fsChartRegion.x,y:_fsChartRegion.y,width:marginRight*devicePixelRatio,height:_fsChartRegion.height},align:"left",textBaseline:"top",fontHeight:font}},xScaler:{textBaseline:"top",font:font+"px Arial",color:"black",region:{x:_fsChartRegion.x,y:_fsChartRegion.y+_fsChartRegion.height,width:_fsChartRegion.width,height:xAxisHeight},data:["09:30","10:30","11:30/13:00","14:00","15:00"],fontHeight:font},volume:{region:_fsVolumeRegion,totalDotsCount:241,borderColor:"gray",splitLineColor:"lightgray",splitLineWidth:lineWidth,verticalLineCount:3,yScalerLeft:{font:font+"px Arial",region:{x:_fsVolumeRegion.x-marginLeft*devicePixelRatio,y:_fsVolumeRegion.y,width:_fsVolumeRegion.x,height:_fsVolumeRegion.height-5},color:"black",align:"right",textBaseline:"top",fontHeight:font},yScalerRight:{font:font+"px Arial",region:{x:_fsVolumeRegion.width+_fsVolumeRegion.x,y:_fsVolumeRegion.y,width:_fsVolumeRegion.x,height:_fsVolumeRegion.height-5},color:"black",align:"left",textBaseline:"top",fontHeight:font}},slider:{bar:{width:20,height:35,borderColor:"black",fillColor:"lightgray"},minBarDistance:20}},klOptions={leftTipSize:{width:38*devicePixelRatio,height:18*devicePixelRatio},bottomTipSize:{width:70*devicePixelRatio,height:18*devicePixelRatio},canvas:klCanvas,riseColor:RiseColor,fallColor:FallColor,normalColor:"black",region:_klChartRegion,barWidth:4*devicePixelRatio,spaceWidth:2*devicePixelRatio,horizontalLineCount:2,verticalLineCount:1,lineStyle:"dashed",borderColor:"gray",splitLineColor:"#eeeeee",circleColor:RiseColor,lineWidth:lineWidth,MAs:[{color:"rgb(255,70,251)",daysCount:5},{color:"rgb(227,150,34)",daysCount:10},{color:"rgb(53,71,107)",daysCount:20}],yAxis:{region:{x:.5,y:_klChartRegion.y,width:marginLeft*devicePixelRatio,height:_klChartRegion.height},font:font+"px Arial",color:"black",fontHeight:font,textBaseline:"top"},xAxis:{region:{x:_klChartRegion.x/2,y:_klChartRegion.y+_klChartRegion.height,width:_klChartRegion.width+_klChartRegion.x/2,height:xAxisHeight},font:font+"px Arial",color:"black",align:"left",fontHeight:font,textBaseline:"top",scalerCount:2,height:xAxisHeight},volume:{region:_klVolumeRegion,lineWidth:lineWidth,horizontalLineCount:1,lineStyle:"dashed",yAxis:{region:{x:_klVolumeRegion.x-marginLeft*devicePixelRatio,y:_klVolumeRegion.y,width:_klVolumeRegion.x,height:_klVolumeRegion.height},font:font+"px Arial",color:"black",align:"right",fontHeight:font,textBaseline:"top"}},slider:{bar:{width:20*devicePixelRatio,height:35*devicePixelRatio,borderColor:"gray",fillColor:"lightgray"},minBarDistance:20*devicePixelRatio}};